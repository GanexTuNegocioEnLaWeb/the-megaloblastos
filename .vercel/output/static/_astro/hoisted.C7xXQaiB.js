async function p(n,t,e){const{callbackUrl:a=window.location.href,redirect:s=!0}=t??{},{prefix:c="/api/auth",...i}=t??{},o=n==="credentials",w=o||n==="email",d=`${`${c}/${o?"callback":"signin"}/${n}`}?${new URLSearchParams(e)}`,u=await fetch(`${c}/csrf`),{csrfToken:f}=await u.json(),l=await fetch(d,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...i,csrfToken:f,callbackUrl:a})}),r=await l.clone().json(),h=new URL(r.url).searchParams.get("error");if(s||!w||!h){window.location.href=r.url??a,r.url.includes("#")&&window.location.reload();return}return l}async function g(n){const{callbackUrl:t=window.location.href,prefix:e="/api/auth"}=n??{},a=await fetch(`${e}/csrf`),{csrfToken:s}=await a.json(),o=(await(await fetch(`${e}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:s,callbackUrl:t})})).json()).url??t;window.location.href=o,o.includes("#")&&window.location.reload()}window.signIn=p;window.signOut=g;
